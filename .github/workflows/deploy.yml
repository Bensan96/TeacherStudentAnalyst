name: Deploy to GitHub Pages and Inject Secrets
on :
push:
branches:
- main # Adjust to 'master'
if needed
workflow_dispatch:
permissions: contents:
read
pages: write id-token: write
concurrency:
group: "pages"
cancel-in-progress: true
jobs: build-and-deploy:
runs-on: ubuntu-latest steps:
- name: Checkout code
uses: actions/checkout@v4
# CRITICAL STEP: Replace the simple
placeholder with the secret key.
# The simplified search pattern
'ÅžGEMINI_API_KEY$' avoids complex escaping issues.
- name: Inject API Key
into index.html
run:
sed -i 's|\$GEMINI_API_KEY\$|$
{f secrets. GEMINI_API_KEY }}Tg' Index.html
- name: Setup Pages
uses: actions/configure-pages@v5
- name: Upload artifact uses: actions/upload-pages-
artifact@v3
with:
path:./'
- name: Deploy to GitHub Pages id: deployment uses: actions/deploy-pages@v4
